<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    <script src = "geometron.js"></script>
    <script src = "trashmagic.js"></script>
    <script>
    
star = "0504,0504,0504,0504,0504,0504,0504,0504,0504,0504,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0502,0504,0502,0502,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0501,0507,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0507,0504,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0500,0507,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0505,0502,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0507,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0507,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0506,0502,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0502,0504,0502,0506,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,";


lsp = "0327,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0502,0505,0502,0501,0506,0501,0501,0501,0506,0501,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0507,0501,0507,0501,0507,0501,0503,0503,0505,0503,0501,0501,0501,0501,0507,0501,0501,0507,0501,0507,0501,0507,0501,0503,0503,0503,0504,0503,0503,0504,0503,0505,0501,0501,0501,0507,0501,0505,0503,0503,0503,0504,0503,0507,0500,0500,0500,0505,0505,0503,0505,0503,0505,0503,0503,0503,0503,0504,0503,0500,0500,0500,0507,0501,0507,0501,0507,0501,0503,0503,0504,0503,0507,0500,0500,0500,0507,0500,0500,0507,0501,0503,0503,0503,0503,0504,0503,0504,0503,0504,0503,0500,0500,0500,0506,0500,0500,0506,0500,0500,0503,0503,0504,0503,0503,0504,0503,0504,0503,0500,0500,0507,0500,0500,0500,0500,0506,0500,0500,0500,0506,0500,0506,0500,0500,0502,0504,0502,0502,0504,0502,0504,0502,0507,0500,0503,0500,0507,0500,0500,0500,0507,0500,0500,0500,0500,0506,0500,0500,0506,0500,0506,0500,0502,0504,0502,0502,0504,0502,0502,0502,0504,0502,0502,0504,0502,0500,0500,0500,0506,0500,0500,0506,0500,0500,0506,0500,0506,0500,0502,0504,0502,0502,0504,0502,0502,0502,0502,0502,0502,0505,0502,0502,0505,0502,0505,0502,0502,0505,0502,0501,0506,0501,0501,0506,0501,0501,0506,0501,0501,0501,0501,0502,0502,0505,0502,0502,0502,0505,0502,0505,0502,0505,0502,0501,0506,0501,0501,0501,0506,0501,0501,0501,0501,0507,0501,0507,0501,0507,0501,0505,0502,0502,0505,0502,0507,0507,0507,0507,0507,0507,0507,0507,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0507,0501,0507,0501,0503,0503,0505,0503,0503,0503,0503,0503,0504,0503,0503,0503,0504,0503,0503,0503,0504,0503,0503,0503,0500,0502,0502,0507,0507,0500,0502,0502,0502,0502,0505,0502,0502,0502,0505,0502,0502,0502,0502,0502,0502,0502,0504,0502,0504,0502,0500,0500,0506,0500,0500,0500,0500,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0503,0507,0501,0501,0501,0501,0507,0501,0501,0501,0501,0501,0501,0506,0501,0501,0506,0501,0501,0501,0506,0501,0501,0506,0501,0506,0501,0501,0506,0501,0503,0505,0503,0500,0503,0500,0507,0500,0503,0500,0507,0500,0500,0507,0500,0500,0507,0500,0500,0500,0500,0500,0500,0500,0500,0500,0500,0500,0506,0500,0500,0500,0504,0504,0504,0504,0506,0506,0506,0504,0506,0502,0502,0502,0504,0502,0504,0502,0507,0500,0507,0500,0505,0505,0505,0506,0502,0505,0502,0502,0502,0502,0504,0502,0500,0507,0500,0503,0503,0503,0507,0507,0507,0507,0507,0500,0500,0503,0501,0504,0507,0504,0500,0502,0502,0502,0502,0506,0506,0506,0506,0506,0506,0506,0506,0505,0505,0502,0502,0504,0502,0502,0505,0505,0503,0503,0504,0502,0507,0507,0507,0504,0504,0504,0504,0504,0504,0324,0500,0500,0507,0500,0500,0506,0500,0504,0502,0503,0503,0503,0500,0507,0500,0500,0500,0505,0505,0503,0501,0503,0503,0503,0503,0505,0502,0505,0502,0502,0501,0507,0501,0501,0501,0504,0502,0504,0502,0502,0505,0502,0505,0502,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0507,0507,0507,";
    
glyph = "0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,";

//glyph = star;

glyph = glyph.replace(/0500,/g, "0406,0406,0403,0407,0405,0404,0407,");
glyph = glyph.replace(/0501,/g, "0406,0406,0402,0407,0405,0404,0407,");
glyph = glyph.replace(/0502,/g, "0406,0406,0401,0407,0405,0404,0407,");
glyph = glyph.replace(/0503,/g, "0406,0406,0400,0407,0405,0404,0407,");
glyph = glyph.replace(/0504,/g, "0406,0406,0403,0407,0407,");
glyph = glyph.replace(/0505,/g, "0406,0406,0402,0407,0407,");
glyph = glyph.replace(/0506,/g, "0406,0406,0401,0407,0407,");
glyph = glyph.replace(/0507,/g, "0406,0406,0400,0407,0407,");

glyph = "0400,0405,0402,0405,0401,0405,0403,0405,";//one unit out and back in the 3 directions, repeated 3 times, with shorter movement each time

//glyph = "0400,0401,";//left,right

glyphStringArray = glyph.split(",");

glyphArray = [];
for(var index = 0;index < glyphStringArray.length;index++){
    if(glyphStringArray[index].length > 0){
        var localaction = parseInt(glyphStringArray[index],8);
        glyphArray.push(parseInt(glyphStringArray[index],8));
    }
}
    
    
//add this function:
//go thru glypharray and every time there's a 0407 double the number of repetitions of an action from 0400 thru 0405, and halve with 0406, always starting with the minimum side unit used in a sequence.
//this requires careful management of the hypercube, or adding some 0407's to the start or both, do when not tired

    
function setup() {
    createCanvas(cellSize*3, cellSize*2);
}

portraitMode = false;
if(innerHeight > innerWidth){
    portraitMode = true;
}


cellSize  = 200;

stepIndex = glyphArray.length + 1;// if this is larger than the length of the array, it will NOT draw the glyph by default.

framesPerSecond= 16;//this can be varied to control the pace of time on the glyph trajectory, which adds analog values to that trajectory.  this can be used as a real time feedback from the electrical probe, which can all be fed into a machine learning algorithm which evolves the geometry.  So the noise lives on top of the Geometron glyph trajectory.  We can also get an analog signal directly into the browser using a motor which as it spins pushes a key repeatedly. if we control the rate of keystrokes, that can feed back into p5js.
unit = 16;//16 frames = 1 second = unit
side = unit;//set to starting unit of 1 second
sideIndex = 0;//step this from 0 to "side" as a side action is carried out

glypheditmode = false;

function draw() {
    frameRate(framesPerSecond);//frames per second
    background(0);
    if (stepIndex < glyphArray.length) {
        //control the robot to run the geometron glyph
        if(glyphArray[stepIndex] == 0400){
            //move to the right for "side" frames
          setTrashotron(true,true,false,false,false,true,portraitMode,cellSize);//right
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0401){
            //move to the left for "side" frames
          setTrashotron(true,true,false,true,true,true,portraitMode,cellSize);//left
          
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0402){
            //towards wall
            setTrashotron(false,false,true,true,true,true,portraitMode,cellSize);
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0403){
            //away from wall
            setTrashotron(false,false,true,true,true,false,portraitMode,cellSize);
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0404){//up
            setTrashotron(true,true,false,true,false,true,portraitMode,cellSize);    
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0405){//down
            setTrashotron(true,true,false,false,true,true,portraitMode,cellSize);        
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0406){
            side /= 2;
            sideIndex = side;
            setTrashotron(false,false,false,true,true,true,portraitMode,cellSize);

        }
        if(glyphArray[stepIndex] == 0407){
            side *= 2;
            sideIndex = side;
            setTrashotron(false,false,false,true,true,true,portraitMode,cellSize);
        }          
        if(glyphArray[stepIndex] == 0410){
            //up and to the left
            setTrashotron(true,false,false,false,true,true,portraitMode,cellSize);    
            sideIndex++;

        }
        if(glyphArray[stepIndex] == 0411){
            //up and to the right
              setTrashotron(false,true,false,true,true,true,portraitMode,cellSize);
            sideIndex++;

        }
        if(glyphArray[stepIndex] == 0412){
            //down and to the right
              setTrashotron(true,false,false,false,true,true,portraitMode,cellSize);//left
            sideIndex++;

        }
        if(glyphArray[stepIndex] == 0413){
            //down and to the left
            setTrashotron(true,false,false,true,false,true,portraitMode,cellSize);    
            sideIndex++;

        }        


        
        if(glyphArray[stepIndex] < 0400 || glyphArray[stepIndex] >= 0500){
            stepIndex++;
        }
        if(sideIndex == side){
              sideIndex = 0;
              stepIndex++;
        }
        if (keyIsDown(0123)) {// s
            //exit the glyph by putting index to greater than length of glyph
            stepIndex = glyphArray.length + 1;
        }
    }
    else{
        if(!glypheditmode){
            fill(255);
            rect(0, 0, cellSize, cellSize);
            rect(cellSize, 0, cellSize, cellSize);
            rect(cellSize*2, 0, cellSize, cellSize);
            if (keyIsDown(0107)) {// g
                stepIndex = 0;//this will cause the glyph to start running
                side = unit;//reset value to unit
            }
            if (keyIsDown(0125)) {// u  towards wall 0402
                setTrashotron(false,false,true,true,true,true,portraitMode,cellSize);
            }
            if (keyIsDown(0110)) {// h out from wall 0403
                setTrashotron(false,false,true,true,true,false,portraitMode,cellSize);
            }
    
            if (keyIsDown(0112)) {// j, left 0401
              setTrashotron(true,true,false,true,true,true,portraitMode,cellSize);//left
            }
            if (keyIsDown(0114)) {// l, right 0400
              setTrashotron(true,true,false,false,false,true,portraitMode,cellSize);//right
            
            }
    
            if (keyIsDown(0111)) {//i, up  0404
              setTrashotron(true,true,false,true,false,true,portraitMode,cellSize);
            }
            if (keyIsDown(0113)) {//k, down 0405
              setTrashotron(true,true,false,false,true,true,portraitMode,cellSize);
            }

//ERFD
//0105,0122,0106,0104,

            if(keyIsDown(0105)){
                //e  up and to the left
              setTrashotron(true,false,false,false,true,true,portraitMode,cellSize);//left
              console.log("[");
            }
            if(keyIsDown(0122)){
                //r  up and to the right
              setTrashotron(false,true,false,true,true,true,portraitMode,cellSize);//left
            }

            if(keyIsDown(0106)){
                //f  down and right
              setTrashotron(true,false,false,false,true,true,portraitMode,cellSize);//left
            }
            if(keyIsDown(0104)){
                //d  down and left
              setTrashotron(false,true,false,true,false,true,portraitMode,cellSize);//left
            }            
            
        }
        else{
            setTrashotron(false,false,false,true,true,true,portraitMode,cellSize);
            //edit the glyph
        }
    }
}



</script>

  </head>
  <body>
      <div id = "cardboard"></div>
      <div id = "iconbox"><canvas id = "icon"></canvas></div>
      
      <a href = "index.html">HOME</a>
      <table>
          <tr>
                <td>CELL SIZE[PX]:</td>
                <td>
                    <input id = "cellsizeinput"/>
                </td>
          </tr>
          <tr>
              <td>GEOMETRON GLYPH:</td>
              <td>
                  <input id = "actioninput"/>
                  <input id = "glyphinput"/>
              </td>
          </tr>
      </table>
     
     <div id = "spellingbox"><canvas id = "spelling"></canvas></div>
     
     <div id = "bannerbox"><canvas id = "banner"></canvas></div>
     <div id = "wallbox"><canvas id = "wallcanvas"></canvas></div>
     <div id ="helpbox">
         USE THE KEYS J,K,L,I TO MOVE ROBOT UP, DOWN, LEFT AND RIGHT USING THE DUAL PULLEY HOISTS. H MOVEs THE PEN OUT FROM THE WALL AND U MOVES IT TOWARD THE WALL.  G(FOR "GO") RUNS THE GLYPH, S(FOR "STOP") QUITS OUT OF RUNNING GLYPH. CHANGE SIZE WITH THE INPUT TO MATCH THE OPTICAL PICKUP UNIT.  HIT "ENTER" TO SWITCH IN AND OUT OF GLYPH EDIT MODE. PASTE DIFFERENT GEOMETRON GLYPHS INTO THE GLYPH INPUT TO CHANGE GLYPH WHICH WILL RUN.
     </div>
     
      <script>
      
      
document.getElementById("wallbox").style.display = "none";

document.getElementById("cellsizeinput").value = cellSize.toString();

document.getElementById("cellsizeinput").onchange = function(){
    cellSize = parseInt(this.value);
    resizeCanvas(3*cellSize, 2*cellSize);
    this.blur();
}

document.getElementById("glyphinput").value = glyph.toString();

document.getElementById("glyphinput").onchange = function(){
    glyph = this.value;
    spellingGVM.spellGlyph(glyph + "0207,");  

    glyphStringArray = glyph.split(",");
    glyphArray = [];
    for(var index = 0;index < glyphStringArray.length;index++){
        if(glyphStringArray[index].length > 0){
            var localaction = parseInt(glyphStringArray[index],8);
            glyphArray.push(parseInt(glyphStringArray[index],8));
        }
    }
    this.blur();
    saveglyph();
}

bannerGlyph = "0337,0337,0337,0337,0337,0347,0325,0336,0336,0336,0336,0336,0333,0333,0333,0330,0336,0330,0335,0337,0337,0305,0311,0201,0335,0350,0201,0335,0335,0201,0335,0335,0201,0335,0335,0201,0335,0335,0335,0335,0337,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0335,0335,0342,0335,0336,0333,0334,0334,0342,0331,0335,0335,0335,0334,0337,0201,0334,0334,0334,0334,0201,0336,0330,0337,0201,0334,0334,0334,0334,0201,0335,0335,0335,0334,0342,0334,0334,0334,0334,0336,0330,0335,0335,0335,0336,0201,0335,0335,0335,0335,0201,0335,0335,0335,0335,0201,0335,0335,0335,0335,0201,0335,0335,0335,0335,0201,0335,0335,0330,0335,0335,0330,0342,0335,0335,0335,0335,0335,0334,0330,0334,0336,0330,0334,0334,0334,0336,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0300,0322,01124,0323,01122,0324,01101,0325,01123,0326,01110,0327,01117,0322,01124,0323,01122,0324,01117,0325,01116,";


var newGVM = new GVM(document.getElementById("banner"),600,200);
newGVM.x0 = 7;
newGVM.y0 = 150;
newGVM.unit = 73;
newGVM.style.color5 = "#00ff00";
newGVM.style.line5 = 3;
newGVM.importbytecode(hypercube);
newGVM.drawGlyph(bannerGlyph);  

var iconGVM = new GVM(document.getElementById("icon"),innerWidth,innerHeight);
iconGVM.x0 = innerWidth/2;
iconGVM.y0 = innerHeight/2;
iconGVM.unit = innerHeight/10;
iconGVM.importbytecode(hypercube);
iconGVM.drawGlyph(lsp);  

spellsize = 30;
spellingGVM = new GVM(document.getElementById("spelling"),spellsize*20,spellsize*10);
spellingGVM.x0 = 2;
spellingGVM.y0 = spellsize + 2;
spellingGVM.unit = spellsize;
spellingGVM.importbytecode(hypercube);
spellingGVM.spellGlyph(glyph + "0207,");  

wallGVM = new GVM(document.getElementById("wallcanvas"),400,400);
wallGVM.importbytecode(hypercube);
wallGVM.unit = 100;

hypercube05xx = [    
    "0500:0400,0335,0342,0334,0333,",
    "0501:0401,0334,0342,0335,0332,",
    "0502:0402,0326,",
    "0503:0403,0322,",
    "0504:0404,0342,0330,",
    "0505:0405,0331,0342,",
    "0506:0406,0336,",
    "0507:0407,0337,",
    "0510:0350,0334,0201,0335,0304,0410,",
    "0511:0350,0335,0201,0334,0304,0411,",
    "0512:0350,0335,0335,0335,0201,0334,0334,0334,0304,0412,",
    "0513:0350,0334,0334,0334,0201,0335,0335,0335,0304,0413,"
];

hypercube015xx = [    
    "01500:01400,",
    "01501:01401,",
    "01502:01402,",
    "01503:01403,",
    "01504:01404,",
    "01505:01405,",
    "01506:01406,",
    "01507:01407,",
    "01510:01410,",
    "01511:01411,",
    "01512:01412,",
    "01513:01413,"
];



//ERFD
//0105,0122,0106,0104,


//erfd
//0145,0162,0146,0144,
diagonalkeys = [
    "0145:0510,",
    "0162:0511,",
    "0146:0512,",
    "0144:0513,"
]

googleyeyes(8);

document.getElementById("actioninput").value = "";

blankkeyboard = [];
for(var index = 040;index <= 0176;index++){
    blankkeyboard.push("0" + index.toString(8) + ":0177,");    
}

simplekeyboard = [
    "055:0506,",
    "075:0507,",
    "0165:0502,",
    "0151:0504,",
    "0150:0503,",
    "0152:0501,",
    "0153:0505,",
    "0154:0500,"
];

spellingGVM.importbytecode(blankkeyboard);
spellingGVM.importbytecode(simplekeyboard);
spellingGVM.importbytecode(diagonalkeys);
spellingGVM.importbytecode(hypercube05xx);
spellingGVM.importbytecode(hypercube015xx);
wallGVM.importbytecode(hypercube05xx);
wallGVM.importbytecode(hypercube015xx);



var httpglyph = new XMLHttpRequest();
httpglyph.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        glyph = this.responseText;
        document.getElementById("glyphinput").value = glyph;        
        glyphStringArray = glyph.split(",");
        glyphArray = [];
        for(var index = 0;index < glyphStringArray.length;index++){
            if(glyphStringArray[index].length > 0){
                var localaction = parseInt(glyphStringArray[index],8);
                if(localaction >= 0500 && localaction <= 0517){
                    localaction -= 0100;
                }
                glyphArray.push(localaction);
            }
        }

        spellingGVM.glyph = glyph + "0207,";
        stepIndex = glyphArray.length + 1;
        spellingGVM.spellGlyph(spellingGVM.glyph);  
        wallGVM.drawGlyph(spellingGVM.glyph);
    }
};
httpglyph.open("GET", "fileloader.php?filename=data/wallglyph.txt", true);
httpglyph.send();

function saveglyph(){
    //save glyph as data/wallglyph.txt
    var httpc = new XMLHttpRequest();
    var url = "filesaver.php";        
    httpc.open("POST", url, true);
    httpc.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=utf-8");
    httpc.send("data="+glyph+"&filename=data/wallglyph.txt");//send text to
}

function setTrashotron(en1,en2,en3,dir1,dir2,dir3,portrait,cellSize){
    if(!portrait){
        resizeCanvas(3*cellSize,2*cellSize);
    }
    else{
        resizeCanvas(2*cellSize,3*cellSize);
    }
    if(en1){//true=black, false=white
        fill(0);//black
        if(!portrait){//landscape
            rect(0,0, cellSize, cellSize);//upper left
        }
        else{//portrait
            rect(cellSize,0, cellSize, cellSize);//upper right
        }
    }
    else{
        fill(255);//white        
        if(!portrait){//landscape
            rect(0,0, cellSize, cellSize);//upper left
        }
        else{//portrait
            rect(cellSize,0, cellSize, cellSize);//upper right
        }
    }

    if(dir1){//true=black, false=white
        fill(0);//black
        if(!portrait){//landscape
            rect(0,cellSize, cellSize, cellSize);//lower left
        }
        else{//portrait
            rect(0,0, cellSize, cellSize);//upper left
        }
    }
    else{
        fill(255);//white        
        if(!portrait){//landscape
            rect(0,cellSize, cellSize, cellSize);//lower left
        }
        else{//portrait
            rect(0,0, cellSize, cellSize);//upper left
        }
    }
    if(en2){//true=black, false=white
        fill(0);//black
        if(!portrait){//landscape
            rect(cellSize,0, cellSize, cellSize);//upper middle
        }
        else{//portrait
            rect(cellSize,cellSize, cellSize, cellSize);//right middle
        }
    }
    else{
        fill(255);//white        
        if(!portrait){//landscape
            rect(cellSize,0, cellSize, cellSize);//upper middle
        }
        else{//portrait
            rect(cellSize,cellSize, cellSize, cellSize);//right middle
        }
    }
    if(dir2){//true=black, false=white
        fill(0);//black
        if(!portrait){//landscape
            rect(cellSize,cellSize, cellSize, cellSize);//bottom  middle
        }
        else{//portrait
            rect(0,cellSize, cellSize, cellSize);//left middle
        }
    }
    else{
        fill(255);//white        
        if(!portrait){//landscape
            rect(cellSize,cellSize, cellSize, cellSize);//bottom  middle
        }
        else{//portrait
            rect(0,cellSize, cellSize, cellSize);//left middle
        }
    }
    if(en3){//true=black, false=white
        fill(0);//black
        if(!portrait){//landscape
            rect(2*cellSize,0, cellSize, cellSize);//upper right
        }
        else{//portrait
            rect(cellSize,2*cellSize, cellSize, cellSize);//lower right
        }
    }
    else{
        fill(255);//white        
        if(!portrait){//landscape
            rect(2*cellSize,0, cellSize, cellSize);//upper right
        }
        else{//portrait
            rect(cellSize,2*cellSize, cellSize, cellSize);//lower right
        }
    }

    if(dir3){//true=black, false=white
        fill(0);//black
        if(!portrait){//landscape
            rect(2*cellSize,cellSize, cellSize, cellSize);//lower right
        }
        else{//portrait
            rect(0,2*cellSize, cellSize, cellSize);//lower left
        }
    }
    else{
        fill(255);//white        
        if(!portrait){//landscape
            rect(2*cellSize,cellSize, cellSize, cellSize);//lower right
        }
        else{//portrait
            rect(0,2*cellSize, cellSize, cellSize);//lower left
        }
    }    
}

function keyPressed() {
  if (keyCode === RETURN) {
      glypheditmode  = !glypheditmode;
      if(glypheditmode){
          document.getElementById("actioninput").select();
          document.getElementById("wallbox").style.display = "block";
          document.getElementById("helpbox").style.display = "none";
      }
      else{
          document.getElementById("actioninput").blur();
          document.getElementById("wallbox").style.display = "none";
          document.getElementById("helpbox").style.display = "block";

      }
  }
}



document.getElementById("actioninput").onkeypress = function(a) {
    var charCode = a.keyCode || a.which;
    if(charCode != 015){
        localCursorAction = parseInt(spellingGVM.hypercube[charCode],8);   

        spellingGVM.cursorAction(localCursorAction);   
        spellingGVM.spellGlyph(spellingGVM.glyph);    
        wallGVM.drawGlyph(spellingGVM.glyph);
        this.value = "";
        spellingGVM.clean();
        glyph = spellingGVM.cleanGlyph;
        document.getElementById("glyphinput").value = spellingGVM.cleanGlyph;
       this.value = "";
       
    }
    glyphStringArray = glyph.split(",");
    
    glyphArray = [];
    for(var index = 0;index < glyphStringArray.length;index++){
        if(glyphStringArray[index].length > 0){
            var localaction = parseInt(glyphStringArray[index],8);
            if(localaction >= 0500 && localaction <= 0517){
                localaction -= 0100;
            }
            glyphArray.push(localaction);
        }
    }
        
    stepIndex = glyphArray.length + 1;// if this is larger than the length of the array, it will NOT draw the glyph by default.    
    saveglyph();
}


document.getElementById("actioninput").onkeydown = function(a) {
    var charCode = a.keyCode || a.which;

    if(charCode == 010) {
        spellingGVM.cursorAction(010);
    }
    if(charCode == 045){
        spellingGVM.cursorAction(020);             
    }
    if(charCode == 047){
        spellingGVM.cursorAction(021);   
    }

    if(charCode == 046){
        //up arrow: prev symbol
        spellingGVM.clean();
        spellingGVM.glyph = "0207," + spellingGVM.cleanGlyph;
        spellingGVM.drawGlyph(spellingGVM.glyph);
        wallGVM.drawGlyph(spellingGVM.glyph);
    }
    if(charCode == 050){
        //down arrow: next symbol
        spellingGVM.clean();
        spellingGVM.glyph = spellingGVM.cleanGlyph + "0207,";
        spellingGVM.drawGlyph(spellingGVM.glyph);
        wallGVM.drawGlyph(spellingGVM.glyph);
    }

    spellingGVM.spellGlyph(spellingGVM.glyph);
        wallGVM.drawGlyph(spellingGVM.glyph);
    
    spellingGVM.clean();
    document.getElementById("glyphinput").value = spellingGVM.cleanGlyph;
    glyph = spellingGVM.cleanGlyph;
    this.value = "";
    
    glyphStringArray = glyph.split(",");
    
    glyphArray = [];
    for(var index = 0;index < glyphStringArray.length;index++){
        if(glyphStringArray[index].length > 0){
            var localaction = parseInt(glyphStringArray[index],8);
            if(localaction >= 0500 && localaction <= 0517){
                localaction -= 0100;
            }
            glyphArray.push(localaction);
        }
    }
        
    stepIndex = glyphArray.length + 1;// if this is larger than the length of the array, it will NOT draw the glyph by default.
    
    saveglyph();
    
}


</script>
<style>
    body,input{
        background-color:#808080;
        font-size:30px;
        font-family:courier;
        font-family:Comic Sans MS;
        overflow:hidden;
        background-color:#9f8767;
    }
    input{
        border:solid;
        border-color:black;
        border-radius:6px;
    }
    a{
        color:#0000ff;
    }
    #actioninput{
        width:0.5em;
    }
    #cardboard{
        position:absolute;
        left:0px;
        top:0px;
        right:0px;
        bottom:0px;
        z-index:-10;
        background-color:#9f8767;
    }
    #iconbox{
        position:absolute;
        left:0px;
        top:0px;
        right:0px;
        bottom:0px;
        z-index:-8;
    }
    main{
        position:absolute;
        right:0px;
        top:0px;
    }
    #bannerbox{
        position:absolute;
        right:0px;
        bottom:0px;
        z-index:0;
    }
    #helpbox{
        position:absolute;
        left:20px;
        bottom:20px;
        overflow:scroll;
        width:300px;
        height:300px;
        color:black;
        font-family:courier;
        border-width:20px;
        border-radius:20px;
        font-size:18px;
        border:solid;
        padding: 1em 1em 1em 1em;
        border-color:black;
        font-family:Comic Sans MS;
        background-color:#9f8767;
    }
    #wallbox{
        position:absolute;
        left:0px;
        border:solid;
        bottom:0px;
        z-index:2;
    }
</style>  
  </body>
</html>
