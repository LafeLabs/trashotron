<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    <script src = "geometron.js"></script>
    <script src = "trashmagic.js"></script>
    <script>
    
star = "0504,0504,0504,0504,0504,0504,0504,0504,0504,0504,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0502,0504,0502,0502,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0501,0507,0501,0501,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0507,0504,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0500,0507,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0500,0507,0500,0500,0505,0502,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0502,0505,0502,0505,0502,0505,0502,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0507,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0507,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0503,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0504,0506,0502,0504,0502,0504,0502,0504,0502,0502,0504,0502,0504,0502,0502,0504,0502,0506,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,";


lsp = "0327,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0506,0502,0505,0502,0501,0506,0501,0501,0501,0506,0501,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0507,0501,0507,0501,0507,0501,0503,0503,0505,0503,0501,0501,0501,0501,0507,0501,0501,0507,0501,0507,0501,0507,0501,0503,0503,0503,0504,0503,0503,0504,0503,0505,0501,0501,0501,0507,0501,0505,0503,0503,0503,0504,0503,0507,0500,0500,0500,0505,0505,0503,0505,0503,0505,0503,0503,0503,0503,0504,0503,0500,0500,0500,0507,0501,0507,0501,0507,0501,0503,0503,0504,0503,0507,0500,0500,0500,0507,0500,0500,0507,0501,0503,0503,0503,0503,0504,0503,0504,0503,0504,0503,0500,0500,0500,0506,0500,0500,0506,0500,0500,0503,0503,0504,0503,0503,0504,0503,0504,0503,0500,0500,0507,0500,0500,0500,0500,0506,0500,0500,0500,0506,0500,0506,0500,0500,0502,0504,0502,0502,0504,0502,0504,0502,0507,0500,0503,0500,0507,0500,0500,0500,0507,0500,0500,0500,0500,0506,0500,0500,0506,0500,0506,0500,0502,0504,0502,0502,0504,0502,0502,0502,0504,0502,0502,0504,0502,0500,0500,0500,0506,0500,0500,0506,0500,0500,0506,0500,0506,0500,0502,0504,0502,0502,0504,0502,0502,0502,0502,0502,0502,0505,0502,0502,0505,0502,0505,0502,0502,0505,0502,0501,0506,0501,0501,0506,0501,0501,0506,0501,0501,0501,0501,0502,0502,0505,0502,0502,0502,0505,0502,0505,0502,0505,0502,0501,0506,0501,0501,0501,0506,0501,0501,0501,0501,0507,0501,0507,0501,0507,0501,0505,0502,0502,0505,0502,0507,0507,0507,0507,0507,0507,0507,0507,0507,0501,0501,0501,0507,0501,0501,0501,0507,0501,0501,0507,0501,0507,0501,0503,0503,0505,0503,0503,0503,0503,0503,0504,0503,0503,0503,0504,0503,0503,0503,0504,0503,0503,0503,0500,0502,0502,0507,0507,0500,0502,0502,0502,0502,0505,0502,0502,0502,0505,0502,0502,0502,0502,0502,0502,0502,0504,0502,0504,0502,0500,0500,0506,0500,0500,0500,0500,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0507,0503,0507,0501,0501,0501,0501,0507,0501,0501,0501,0501,0501,0501,0506,0501,0501,0506,0501,0501,0501,0506,0501,0501,0506,0501,0506,0501,0501,0506,0501,0503,0505,0503,0500,0503,0500,0507,0500,0503,0500,0507,0500,0500,0507,0500,0500,0507,0500,0500,0500,0500,0500,0500,0500,0500,0500,0500,0500,0506,0500,0500,0500,0504,0504,0504,0504,0506,0506,0506,0504,0506,0502,0502,0502,0504,0502,0504,0502,0507,0500,0507,0500,0505,0505,0505,0506,0502,0505,0502,0502,0502,0502,0504,0502,0500,0507,0500,0503,0503,0503,0507,0507,0507,0507,0507,0500,0500,0503,0501,0504,0507,0504,0500,0502,0502,0502,0502,0506,0506,0506,0506,0506,0506,0506,0506,0505,0505,0502,0502,0504,0502,0502,0505,0505,0503,0503,0504,0502,0507,0507,0507,0504,0504,0504,0504,0504,0504,0324,0500,0500,0507,0500,0500,0506,0500,0504,0502,0503,0503,0503,0500,0507,0500,0500,0500,0505,0505,0503,0501,0503,0503,0503,0503,0505,0502,0505,0502,0502,0501,0507,0501,0501,0501,0504,0502,0504,0502,0502,0505,0502,0505,0502,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0505,0507,0507,0507,";
    
glyph = "0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,0400,0401,0402,0403,0404,0405,";

//glyph = star;

glyph = glyph.replace(/0500,/g, "0406,0406,0403,0407,0405,0404,0407,");
glyph = glyph.replace(/0501,/g, "0406,0406,0402,0407,0405,0404,0407,");
glyph = glyph.replace(/0502,/g, "0406,0406,0401,0407,0405,0404,0407,");
glyph = glyph.replace(/0503,/g, "0406,0406,0400,0407,0405,0404,0407,");
glyph = glyph.replace(/0504,/g, "0406,0406,0403,0407,0407,");
glyph = glyph.replace(/0505,/g, "0406,0406,0402,0407,0407,");
glyph = glyph.replace(/0506,/g, "0406,0406,0401,0407,0407,");
glyph = glyph.replace(/0507,/g, "0406,0406,0400,0407,0407,");


glyph = "0400,0401,0402,0403,0404,0405,0406,0400,0401,0402,0403,0404,0405,0406,0400,0401,0402,0403,0404,0405,";//one unit out and back in the 3 directions, repeated 3 times, with shorter movement each time

//glyph = "0400,0401,";//left,right



glyphStringArray = glyph.split(",");

glyphArray = [];
for(var index = 0;index < glyphStringArray.length;index++){
    if(glyphStringArray[index].length > 0){
        var localaction = parseInt(glyphStringArray[index],8);
        glyphArray.push(parseInt(glyphStringArray[index],8));
    }
}
    
    
//add this function:
//go thru glypharray and every time there's a 0407 double the number of repetitions of an action from 0400 thru 0405, and halve with 0406, always starting with the minimum side unit used in a sequence.
//this requires careful management of the hypercube, or adding some 0407's to the start or both, do when not tired

    
function setup() {
    createCanvas(cellSize*3, cellSize*2);
}



cellSize  = 200;

stepIndex = glyphArray.length + 1;// if this is larger than the length of the array, it will NOT draw the glyph by default.

framesPerSecond= 16;//this can be varied to control the pace of time on the glyph trajectory, which adds analog values to that trajectory.  this can be used as a real time feedback from the electrical probe, which can all be fed into a machine learning algorithm which evolves the geometry.  So the noise lives on top of the Geometron glyph trajectory.  We can also get an analog signal directly into the browser using a motor which as it spins pushes a key repeatedly. if we control the rate of keystrokes, that can feed back into p5js.
unit = 16;//16 frames = 1 second = unit
side = unit;//set to starting unit of 1 second
sideIndex = 0;//step this from 0 to "side" as a side action is carried out

function draw() {
    frameRate(framesPerSecond);//frames per second
    background(0);
    if (stepIndex < glyphArray.length) {
        //control the robot to run the geometron glyph
        if(glyphArray[stepIndex] == 0400){
            //move to the left for "side" frames
            fill(255);
            rect(cellSize, 0, cellSize, cellSize);//
            rect(cellSize*2, 0, cellSize, cellSize);
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0401){
            //move to the right for "side" frames
            fill(255);
            rect(cellSize, 0, cellSize, cellSize);
            rect(cellSize*2, 0, cellSize, cellSize);
            rect(0, cellSize, cellSize, cellSize);
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0402){
            fill(255);
            rect(0, 0, cellSize, cellSize);
            rect(cellSize*2, 0, cellSize, cellSize);
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0403){
            fill(255);
            rect(0, 0, cellSize, cellSize);
            rect(cellSize*2, 0, cellSize, cellSize);
            rect(cellSize, cellSize, cellSize, cellSize);
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0404){
            fill(255);
            rect(0, 0, cellSize, cellSize);
            rect(cellSize, 0, cellSize, cellSize);
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0405){
            fill(255);
            rect(0, 0, cellSize, cellSize);
            rect(cellSize, 0, cellSize, cellSize);
            rect(cellSize*2, cellSize, cellSize, cellSize);
            sideIndex++;
        }
        if(glyphArray[stepIndex] == 0406){
            side /= 2;
            sideIndex = side;
            fill(255);
            rect(0, 0, cellSize, cellSize);
            rect(cellSize, 0, cellSize, cellSize);
            rect(cellSize*2, 0, cellSize, cellSize);

        }
        if(glyphArray[stepIndex] == 0407){
            side *= 2;
            sideIndex = side;
            fill(255);
            rect(0, 0, cellSize, cellSize);
            rect(cellSize, 0, cellSize, cellSize);
            rect(cellSize*2, 0, cellSize, cellSize);
        }          
        if(glyphArray[stepIndex] < 0400 || glyphArray[stepIndex] >= 0500){
            stepIndex++;
        }
        if(sideIndex == side){
              sideIndex = 0;
              stepIndex++;
        }
        if (keyIsDown(0121)) {// q/Q
            //exit the glyph by putting index to greater than length of glyph
            stepIndex = glyphArray.length + 1;
        }
    }
    else{
        fill(255);
        rect(0, 0, cellSize, cellSize);
        rect(cellSize, 0, cellSize, cellSize);
        rect(cellSize*2, 0, cellSize, cellSize);
        if (keyIsDown(040)) {// space bar
            stepIndex = 0;//this will cause the glyph to start running
            side = unit;//reset value to unit
        }
        if (keyIsDown(0101)) {// a, up
          fill(255);
          rect(0, 0, cellSize, cellSize);
          rect(cellSize, 0, cellSize, cellSize);
          fill(0);
          rect(cellSize*2, 0, cellSize, cellSize);
        }
        if (keyIsDown(0132)) {// z, down
          fill(255);
          rect(0, 0, cellSize, cellSize);
          rect(cellSize, 0, cellSize, cellSize);
          rect(2*cellSize, cellSize, cellSize, cellSize);
          fill(0);
          rect(cellSize*2, 0, cellSize, cellSize);
        }

        if (keyIsDown(0112)) {// j, left
          fill(255);
          rect(cellSize, 0, cellSize, cellSize);
          rect(cellSize*2, 0, cellSize, cellSize);
          fill(0);
          rect(0,0, cellSize, cellSize);
        }
        if (keyIsDown(0114)) {// l, right
          fill(255);
          rect(cellSize, 0, cellSize, cellSize);
          rect(cellSize*2, 0, cellSize, cellSize);
          rect(0,cellSize, cellSize, cellSize);
          fill(0);
          rect(0,0, cellSize, cellSize);
        }

        if (keyIsDown(0111)) {//i, away
          fill(255);
          rect(0, 0, cellSize, cellSize);
          rect(cellSize*2, 0, cellSize, cellSize);
          fill(0);
          rect(cellSize,0, cellSize, cellSize);
        }
        if (keyIsDown(0113)) {//k, towards
          fill(255);
          rect(0, 0, cellSize, cellSize);
          rect(cellSize*2, 0, cellSize, cellSize);
          rect(cellSize, cellSize, cellSize, cellSize);
          fill(0);
          rect(cellSize,0, cellSize, cellSize);
        }
        
        
    }
}
</script>

  </head>
  <body>
      <div id = "cardboard"></div>
      <div id = "iconbox"><canvas id = "icon"></canvas></div>
      
      <a href = "index.html">HOME</a>
      <table>
          <tr>
                <td>CELL SIZE[PX]:</td>
                <td>
                    <input id = "cellsizeinput"/>
                </td>
          </tr>
          <tr>
              <td>GEOMETRON GLYPH:</td>
              <td>
                  <input id = "glyphinput"/>
              </td>
          </tr>
      </table>
     
     <div id = "spellingbox"><canvas id = "spelling"></canvas></div>
     
     <div id = "bannerbox"><canvas id = "banner"></canvas></div>
     
     <div id ="helpbox">
         USE THE KEYS J,K,L,I TO MOVE ROBOT FORWARD, BACK, LEFT AND RIGHT, USE KEYS A AND Z TO MOVE UP AND DOWN, SPACE BAR RUNS THE GLYPH, Q QUITS OUT OF RUNNING GLYPH. CHANGE SIZE WITH THE INPUT TO MATCH THE OPTICAL PICKUP UNIT.  PASTE DIFFERENT GEOMETRON GLYPHS INTO THE GLYPH INPUT TO CHANGE GLYPH WHICH WILL RUN.
     </div>
     <script>
      
      
document.getElementById("cellsizeinput").value = cellSize.toString();

document.getElementById("cellsizeinput").onchange = function(){
    cellSize = parseInt(this.value);
    resizeCanvas(3*cellSize, 2*cellSize);
    this.blur();
}

document.getElementById("glyphinput").value = glyph.toString();

document.getElementById("glyphinput").onchange = function(){
    glyph = this.value;
    spellingGVM.spellGlyph(glyph + "0207,");  

    glyphStringArray = glyph.split(",");
    
    glyphArray = [];
    for(var index = 0;index < glyphStringArray.length;index++){
        if(glyphStringArray[index].length > 0){
            var localaction = parseInt(glyphStringArray[index],8);
            glyphArray.push(parseInt(glyphStringArray[index],8));
        }
    }
    this.blur();
}

bannerGlyph = "0337,0337,0337,0337,0337,0347,0325,0336,0336,0336,0336,0336,0333,0333,0333,0330,0336,0330,0335,0337,0337,0305,0311,0201,0335,0350,0201,0335,0335,0201,0335,0335,0201,0335,0335,0201,0335,0335,0335,0335,0337,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0335,0335,0342,0335,0336,0333,0334,0334,0342,0331,0335,0335,0335,0334,0337,0201,0334,0334,0334,0334,0201,0336,0330,0337,0201,0334,0334,0334,0334,0201,0335,0335,0335,0334,0342,0334,0334,0334,0334,0336,0330,0335,0335,0335,0336,0201,0335,0335,0335,0335,0201,0335,0335,0335,0335,0201,0335,0335,0335,0335,0201,0335,0335,0335,0335,0201,0335,0335,0330,0335,0335,0330,0342,0335,0335,0335,0335,0335,0334,0330,0334,0336,0330,0334,0334,0334,0336,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0334,0334,0334,0334,0201,0300,0322,01124,0323,01122,0324,01101,0325,01123,0326,01110,0327,01117,0322,01124,0323,01122,0324,01117,0325,01116,";


var newGVM = new GVM(document.getElementById("banner"),600,200);
newGVM.x0 = 7;
newGVM.y0 = 150;
newGVM.unit = 73;
newGVM.style.color5 = "#00ff00";
newGVM.style.line5 = 3;
newGVM.importbytecode(hypercube);
newGVM.drawGlyph(bannerGlyph);  

var iconGVM = new GVM(document.getElementById("icon"),innerWidth,innerHeight);
iconGVM.x0 = innerWidth/2;
iconGVM.y0 = innerHeight/2;
iconGVM.unit = innerHeight/10;
iconGVM.importbytecode(hypercube);
iconGVM.drawGlyph(lsp);  

spellsize = 30;
var spellingGVM = new GVM(document.getElementById("spelling"),spellsize*20,spellsize*10);
spellingGVM.x0 = 2;
spellingGVM.y0 = spellsize + 2;
spellingGVM.unit = spellsize;
spellingGVM.importbytecode(hypercube);
spellingGVM.spellGlyph(glyph + "0207,");  

googleyeyes(8);


  </script>
<style>
    body,input{
        background-color:#808080;
        font-size:30px;
        font-family:courier;
        font-family:Comic Sans MS;
        overflow:hidden;
        background-color:#9f8767;
    }
    input{
        border:solid;
        border-color:black;
        border-radius:6px;
    }
    a{
        color:#0000ff;
    }
    #cardboard{
        position:absolute;
        left:0px;
        top:0px;
        right:0px;
        bottom:0px;
        z-index:-10;
        background-color:#9f8767;
    }
    #iconbox{
        position:absolute;
        left:0px;
        top:0px;
        right:0px;
        bottom:0px;
        z-index:-8;
    }
    main{
        position:absolute;
        right:0px;
        bottom:0px;
    }
    #bannerbox{
        position:absolute;
        right:0px;
        top:0px;
        z-index:0;
    }
    #helpbox{
        position:absolute;
        left:20px;
        bottom:20px;
        overflow:scroll;
        width:300px;
        height:300px;
        color:black;
        font-family:courier;
        border-width:20px;
        border-radius:20px;
        font-size:18px;
        border:solid;
        padding: 1em 1em 1em 1em;
        border-color:black;
        font-family:Comic Sans MS;
        background-color:#9f8767;
    }
</style>  
  </body>
</html>
