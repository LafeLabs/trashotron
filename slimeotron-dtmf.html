<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <!--

        EVERYTHING IS PHYSICAL
        EVERYTHING IS FRACTAL
        EVERYTHING IS RECURSIVE
        NO MONEY
        MO MINING
        NO PROPERTY
        LOOK AT THE INSECTS
        LOOK AT THE FUNGI
        LANGUAGE IS HOW THE MIND PARSES REALITY

    -->
    <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAP//AP///wANAP8A5Dz6ABueRwAAt/8A6BonABo86AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAREREREREREREREAAAEREREREQCIgREREd3dwAAB3d3d3d3d3d3d3d3d3d3d3d3d3VVVVVVVQAFVVAAVVVQIiBRAiIBEQIAIBECAAERAgAgFgIABmYCIiBmAiIGZgIiIGYCIgZmYCIAaIAAMzMzAAiIiIiIiIiIiIiIiIiIiIiIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rel="icon" type="image/x-icon" />

    <!--Stop Google:-->
    <META NAME="robots" CONTENT="noindex,nofollow">
    <script src="https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.js"></script>
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/addons/p5.sound.js"></script>
    
<script>
/*
 * @name Oscillator Frequency
 * @description <p>Control an Oscillator and view the waveform using FFT.
 * MouseX is mapped to frequency, mouseY is mapped to amplitude.</p>
 * <p><em><span class="small"> To run this example locally, you will need the
 * <a href="http://p5js.org/reference/#/libraries/p5.sound">p5.sound library</a> and a
 * sound file.</span></em></p>
 */
let osc, fft;

frameIndex = -30;

pulseIndex = -30;

pulse1 = 0;
pulse2 = 0;
en1 = true;
en2 = true;
en3 = true;
dir1 = false;
dir2 = false;
dir3 = false;

imagemode = false;

function setup() {
  createCanvas(innerWidth, innerHeight);
  mic = new p5.AudioIn();
  mic.start();
  fft2 = new p5.FFT();
  fft2.setInput(mic);

  osc = new p5.SinOsc(); // set frequency and type
  osc.amp(0);
  osc2 = new p5.SinOsc(); // set frequency and type
  osc2.amp(0);
  osc.start();
  osc2.start();
  freq = 697;
  osc.freq(freq);  
  background(0);
  
  
  button = createButton('image mode');
  button.position(100, 0);
  button.mousePressed(imagemodeset);
  button = createButton('one');
  button.position(100, 100);
  button.mousePressed(onetone);
  button = createButton('two');
  button.position(200, 100);
  button.mousePressed(twotone);
  button = createButton('three');
  button.position(300, 100);
  button.mousePressed(threetone);
  
  button = createButton('four');
  button.position(100, 200);
  button.mousePressed(fourtone);
  button = createButton('five');
  button.position(200, 200);
  button.mousePressed(fivetone);
  button = createButton('six');
  button.position(300, 200);
  button.mousePressed(sixtone);
    
}

function onetone(){
    pulse2 = 0;
    pulse1 = 1;
    pulseIndex = 0;
}
function twotone(){
    pulse2 = 0;
    pulse1 = 2;
    pulseIndex = 0;
}
function threetone(){
    pulse2 = 0;
    pulse1 = 3;
    pulseIndex = 0;
}


function fourtone(){
    pulse1 = 0;
    pulse2 = 4;
    pulseIndex = 0;
}
function fivetone(){
    pulse1 = 0;
    pulse2 = 5;
    pulseIndex = 0;
}
function sixtone(){
    pulse1 = 0;
    pulse2 = 6;
    pulseIndex = 0;
}


function imagemodeset() {
    imagemode = !imagemode;
}

function draw() {

  frameRate(30);
//  background(255);

//  let waveform = fft.waveform(); // analyze the waveform

 /* 
  beginShape();
  strokeWeight(5);
  for (let i = 0; i < waveform.length; i++) {
    let x = map(i, 0, waveform.length, 0, width);
    let y = map(waveform[i], -1, 1, height, 0);
    vertex(x, y);
  }
  endShape();
*/
  
  if(pulseIndex < -20){
         //1
        freq = 697;
        osc.freq(freq);
        osc.amp(0.5);
        freq2 = 1209;
        osc2.freq(freq2);  
        osc2.amp(0.5);
  }
   if(pulseIndex >= -20 && pulseIndex < -15){
        osc.amp(0);
        osc2.amp(0);
   }
 
  if(pulseIndex >= -15 && pulseIndex < -10){
         //2
        freq = 697;
        osc.freq(freq);
        amp = 0.5;
        osc.amp(amp);
        freq2 = 1477;
        osc2.freq(freq2);
        amp2 = 0.5;
        osc2.amp(amp2);

  }
    if(pulseIndex >= -10 && pulseIndex < -5){
        osc.amp(0);
        osc2.amp(0);
   }
 
  if(pulseIndex >= -5 && pulseIndex < 0){
         //3
      freq = 697;
      osc.freq(freq);
      amp = 0.5;
      osc.amp(amp);
      freq2 = 1477;
      osc2.freq(freq2);
      amp2 = 0.5;
      osc2.amp(amp2);

  }


  if(pulseIndex < 5 && pulseIndex >=0){
     if(pulse2 == 4){
        freq = 770;
        osc.freq(freq);
        amp = 0.5;
        osc.amp(amp);
        freq2 = 1209;
        osc2.freq(freq2);
        amp2 = 0.5;
        osc2.amp(amp2);
     } 
     if(pulse2 == 5){
        freq = 770;
        osc.freq(freq);
        amp = 0.5;
        osc.amp(amp);
        freq2 = 1336;
        osc2.freq(freq2);
        amp2 = 0.5;
        osc2.amp(amp2);
     } 
     if(pulse2 == 6){
        freq = 770;
        osc.freq(freq);
        amp = 0.5;
        osc.amp(amp);
        freq2 = 1477;
        osc2.freq(freq2);
        amp2 = 0.5;
        osc2.amp(amp2);
     } 
      if(pulse2 == 0){
        amp = 0;
        osc.amp(amp);
        amp2 = 0;
        osc2.amp(amp2);        
    //    pulseIndex += 5;
 
      }

  }
  if(pulseIndex < 10 && pulseIndex >= 5){
      amp = 0;
        osc.amp(amp);
        amp2 = 0;
        osc2.amp(amp2);        

  }
  if(pulseIndex < 15 && pulseIndex >= 10){
      if(pulse1 == 1){
        freq = 697;
        osc.freq(freq);
        osc.amp(0.5);
        freq2 = 1209;
        osc2.freq(freq2);  
        osc2.amp(0.5);
      }
      if(pulse1 == 2){
        freq = 697;
        osc.freq(freq);
        amp = 0.5;
        osc.amp(amp);
        freq2 = 1336;
        osc2.freq(freq2);
        amp2 = 0.5;
        osc2.amp(amp2);
      }
      if(pulse1 == 3){
        freq = 697;
        osc.freq(freq);
        amp = 0.5;
        osc.amp(amp);
        freq2 = 1477;
        osc2.freq(freq2);
        amp2 = 0.5;
        osc2.amp(amp2);
      }
      if(pulse1 == 0){
        amp = 0;
        osc.amp(amp);
        amp2 = 0;
        osc2.amp(amp2);        
       // pulseIndex += 5;
      }
  
  }
  if(pulseIndex >= 15){
    amp = 0;
    osc.amp(amp);
    amp2 = 0;
    osc2.amp(amp2);
  }
  pulseIndex++;
    
    
if(imagemode){

  let spectrum = fft2.analyze();
  nyquistFreq = sampleRate() / 2;
  binFreq = nyquistFreq / (spectrum.length);
  i1000 = Math.round(1000/binFreq);
  stroke(0,255,0);

//  line(0,height - 3*i1000,width,height - 3*i1000);

  strokeWeight(5);
  for (let i = 0; i < spectrum.length; i++) {
    //stroke(spectrum[i]);
    
        n = 256;
        H = spectrum[i]*360/n;
        z = 255*(1 - Math.abs((H/60)%2 - 1));
    
        if(H < 60){
            redz = 255;
            greenz = Math.round(z);
            bluez = 0;
        }
        if(H >= 60 && H < 120){
            redz = Math.round(z);
            greenz = 255;
            bluez = 0;
        }
        if(H >= 120 && H < 180){
            redz = 0;
            greenz = 255;
            bluez = Math.round(z);
        }
        if(H >= 180 && H < 240){
            redz = 0;    
            greenz = Math.round(z);
            bluez = 255;
        }
        if(H >= 240 && H < 300){
            redz = Math.round(z);    
            greenz = 0;
            bluez = 255;
        }
        if(H >= 300 && H < 360){
            redz = 255;    
            greenz = 0;
            bluez = Math.round(z);
        }    
    
    stroke(0);
    point(frameIndex,height - 3*i);
//     stroke('rgb(' + red + ',' + green + ',' + blue + ')');
    stroke('rgba(' + redz + ',' + greenz + ',' + bluez + ',' + spectrum[i]/10 + ')');
    
    point(frameIndex,height - 3*i);
  }
//  i1000 = 
  frameIndex += 3;
  if(frameIndex > width){
      frameIndex = 0;
  }

    
}  
else{
    background(255);
}

  
}


function keyPressed() {
  if (key === "j") {
      if(dir1 == true){
        pulse2 = 4;      
        dir1 = false;
      }
      else{  
        pulse2 = 0;
      }    
      pulse1 = 1;
      pulseIndex = 0;
  }
  if (key === "l") {
      pulse1 = 1;
      if(dir1 == false){
        pulse2 = 4;      
        dir1 = true;
      }
      else{  
        pulse2 = 0;
      }    

      pulseIndex = 0;
  }
  if (key === "i") {
      pulse1 = 2;
      if(dir2 == true){
        pulse2 = 5;      
        dir2 = false;
      }
      else{  
        pulse2 = 0;
      }    
      pulseIndex = 0;
  }
  if (key === "k") {
      pulse1 = 2;
      if(dir2 == false){
        pulse2 = 5;      
        dir2 = true;
      }
      else{  
        pulse2 = 0;
      }    

    pulseIndex = 0;
  }
  if (key === "u") {
      pulse1 = 3;
      if(dir3 == true){
        pulse2 = 6;      
        dir3 = false;
      }
      else{  
        pulse2 = 0;
      }    
    pulseIndex = 0;
  }
  if (key === "h") {
      pulse1 = 3;
      if(dir3 == false){
        pulse2 = 6;      
        dir3 = true;
      }
      else{  
        pulse2 = 0;
      }    

    pulseIndex = 0;
  }
  if(key== " "){
      imagemode = !imagemode;
  }
}

</script>
</head>
<body>    
<a href = "index.html">HOME</a>
<style>

</style>
</body>
</html>
